<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>The Olympic Journey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>

    <style>
        body {
            color: #404040;
            font:
                400 15px/22px 'Open Sans',
                'Helvetica Neue',
                sans-serif;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        * {
            box-sizing: border-box;
        }

        .sidebar {
            position: absolute;
            height: 40%;
            width: 100%;
            bottom: 0;
            left: 0;
            overflow: hidden;
        }

        .map {
            position: absolute;
            height: 60%;
            width: 100%;
        }

        h1 {
            font-size: 22px;
            margin: 0;
            font-weight: 400;
            line-height: 20px;
            padding: 20px 2px;
        }

        a {
            color: #404040;
            text-decoration: none;
        }

        a:hover {
            color: #101010;
        }

        .title-bar {
            position: absolute;
            opacity: 0.5;
            top: 8px;
            line-height: 60px;
            padding: 0 10px;
            background-color: #212121;
            color: #fff;
            width: 100%;
            height: 60px;
            z-index: 1;
            display: inline-block;
            text-align: center;
        }

        .title-bar h1 {
            display: inline;
            font-family: 'Open Sans', 'Helvetica Neue', sans-serif;
            font-style: italic;
            font-weight: 700;
            text-transform: uppercase;
            margin: 0;
            font-weight: 400;
            line-height: 20px;
            padding: 20px 2px;
            text-align: center;
        }

        .title-bar img {
            position: relative;
            top: 5px;
            left: 0;
            display: inline;
        }

        .detail-bar {
            position: absolute;
            opacity: 0.5;
            top: 74px;
            line-height: 60px;
            padding: 0 10px;
            background-color: #212121;
            color: #fff;
            width: 100%;
            height: 160px;
            z-index: 1;
            overflow-y: scroll;
        }

        .heading {
            background: #fff;
            border-bottom: 1px solid #eee;
            line-height: 60px;
            padding: 0 10px;
            background-color: #020548;
            color: #fff;
            position: relative;
            width: 100%;
            height: fit-content;
        }

        .listings {
            height: 84%;
            overflow: auto;
            padding-bottom: 0;
        }

        .listings .item {
            display: block;
            border-bottom: 1px solid #eee;
            padding: 10px;
            text-decoration: none;
        }

        .listings .item:last-child {
            border-bottom: none;
        }

        .listings .item .title {
            display: block;
            color: #03094d;
            font-weight: 700;
        }

        .listings .item .title small {
            font-weight: 400;
        }

        .listings .item.active .title,
        .listings .item .title:hover {
            color: #3BC4FF;
        }

        .listings .item.active {
            background-color: #f8f8f8;
        }

        ::-webkit-scrollbar {
            width: 3px;
            height: 3px;
            border-left: 0;
            background: rgb(0 0 0 / 10%);
        }

        ::-webkit-scrollbar-track {
            background: none;
        }

        ::-webkit-scrollbar-thumb {
            background: #03094d;
            border-radius: 0;
        }

        .marker {
            border: none;
            cursor: pointer;
            height: 56px;
            width: 56px;
            background-image: url('./olympics/img/torch.png');
        }

        /* Marker tweaks */
        .mapboxgl-popup {
            padding-bottom: 60px;
        }

        .mapboxgl-popup-close-button {
            display: none;
        }

        .mapboxgl-popup-content {
            font:
                400 15px/22px 'Open Sans',
                'Helvetica Neue',
                sans-serif;
            padding: 0;
            width: 180px;
            border-radius: 10px;
        }

        .mapboxgl-popup-content h3 {
            background: #050848;
            color: #fff;
            margin: 0;
            padding: 10px;
            border-radius: 10px 10px 0 0;
            font-weight: 700;
            margin-top: -15px;
        }

        .mapboxgl-popup-content h4 {
            margin: 0;
            padding: 10px;
            font-weight: 400;
        }

        .mapboxgl-popup-content div {
            padding: 10px;
        }

        .mapboxgl-popup-anchor-top>.mapboxgl-popup-content {
            margin-top: 15px;
        }

        .mapboxgl-popup-anchor-top>.mapboxgl-popup-tip {
            border-bottom-color: #fff;
        }

        /* search */
        #search {
            position: relative;
            top: 0;
            left: 0;
            z-index: 1;
            width: 80%;
            padding: 10px;
            font-size: 16px;
            font-family: 'Open Sans', 'Helvetica Neue', sans-serif;
            border-radius: 10px;
        }

        #clear-search {
            position: relative;
            top: 0;
            left: 0;
            z-index: 1;
            padding: 10px;
            font-size: 10px;
            font-family: 'Open Sans', 'Helvetica Neue', sans-serif;
            border-radius: 40px;
        }
    </style>
</head>

<body>
    <div class="title-bar">
        <!-- add a hamburger menu to the left of the heading using ./olympics/img/menu.svg -->
        <img src="./olympics/img/menu.svg" alt="menu">
        <h1>The Olympic Journey</h1>
    </div>
    <div class="detail-bar" style="display: none;">Details</div>
    <div class="sidebar">
        <div class="heading">
            <!-- add a simple search bar -->
            <input id="search" type="text" placeholder="Search...">
            <button id="clear-search">reset</button>

        </div>
        <div id="listings" class="listings"></div>
    </div>
    <div id="map" class="map"></div>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiZ3JhZmEiLCJhIjoiY2ptYjNtZWxnMDBrdDNwbnVicGJzOWg2NyJ9.9OulyCe3kEqMAXPbx1mKUA';

        /**
         * Add the map to the page
         */
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/grafa/clvcti9gb00ue01rjhg1n7y5d',
            center: [-77.034084142948, 38.909671288923],
            zoom: 1,
            scrollZoom: true
        });

        const summerVenues = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            23.717,
                            37.967
                        ]
                    },
                    "properties": {
                        "Year": "1896 & 2004 Summer Olympics",
                        "City": "Athens",
                        "Country": "Greece",
                        "Times_Hosted": 2,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            2.351,
                            48.857
                        ]
                    },
                    "properties": {
                        "Year": "1900 & 1924 & 2024 Summer Olympics",
                        "City": "Paris",
                        "Country": "France",
                        "Times_Hosted": 2,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -90.198,
                            38.627
                        ]
                    },
                    "properties": {
                        "Year": "1904 Summer Olympics",
                        "City": "St. Louis",
                        "Country": "United States",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -0.123,
                            51.507
                        ]
                    },
                    "properties": {
                        "Year": "1908 & 1948 & 2012  Summer Olympics",
                        "City": "London",
                        "Country": "England",
                        "Times_Hosted": 3,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            18.068,
                            59.329
                        ]
                    },
                    "properties": {
                        "Year": "1912  Summer Olympics",
                        "City": "Stockholm",
                        "Country": "Sweden",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            4.4,
                            51.217
                        ]
                    },
                    "properties": {
                        "Year": "1920  Summer Olympics",
                        "City": "Antwerp",
                        "Country": "Belgium",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            4.9,
                            52.367
                        ]
                    },
                    "properties": {
                        "Year": "1928  Summer Olympics",
                        "City": "Amsterdam",
                        "Country": "Netherlands",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -118.25,
                            34.05
                        ]
                    },
                    "properties": {
                        "Year": "1932 & 1984 Summer Olympics",
                        "City": "Los Angeles",
                        "Country": "United States",
                        "Times_Hosted": 2,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            13.383,
                            52.517
                        ]
                    },
                    "properties": {
                        "Year": "1936 Summer Olympics",
                        "City": "Berlin",
                        "Country": "Germany",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            24.938,
                            60.171
                        ]
                    },
                    "properties": {
                        "Year": "1952 Summer Olympics",
                        "City": "Helsinki",
                        "Country": "Finland",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            144.963,
                            -37.814
                        ]
                    },
                    "properties": {
                        "Year": "1956 Summer Olympics",
                        "City": "Melbourne",
                        "Country": "Australia",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            12.5,
                            41.9
                        ]
                    },
                    "properties": {
                        "Year": "1960 Summer Olympics",
                        "City": "Rome",
                        "Country": "Italy",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            139.683,
                            35.683
                        ]
                    },
                    "properties": {
                        "Year": "1964 & 2021 Summer Olympics",
                        "City": "Tokyo",
                        "Country": "Japan",
                        "Times_Hosted": 2,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -99.133,
                            19.433
                        ]
                    },
                    "properties": {
                        "Year": "1968 Summer Olympics",
                        "City": "Mexico City",
                        "Country": "Mexico",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            11.567,
                            48.133
                        ]
                    },
                    "properties": {
                        "Year": "1972 Summer Olympics",
                        "City": "Munich",
                        "Country": "West Germany",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -73.567,
                            45.502
                        ]
                    },
                    "properties": {
                        "Year": "1976 Summer Olympics",
                        "City": "Montreal",
                        "Country": "Canada",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            37.615,
                            55.75
                        ]
                    },
                    "properties": {
                        "Year": "1980 Summer Olympics",
                        "City": "Moscow",
                        "Country": "USSR",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            126.967,
                            37.567
                        ]
                    },
                    "properties": {
                        "Year": "1988 Summer Olympics",
                        "City": "Seoul",
                        "Country": "South Korea",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            2.183,
                            41.383
                        ]
                    },
                    "properties": {
                        "Year": "1992 Summer Olympics",
                        "City": "Barcelona",
                        "Country": "Spain",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -84.39,
                            33.755
                        ]
                    },
                    "properties": {
                        "Year": "1996 Summer Olympics",
                        "City": "Atlanta",
                        "Country": "United States",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            151.21,
                            -33.865
                        ]
                    },
                    "properties": {
                        "Year": "2000 Summer Olympics",
                        "City": "Sydney",
                        "Country": "Australia",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            116.38,
                            39.917
                        ]
                    },
                    "properties": {
                        "Year": "2008 Summer Olympics",
                        "City": "Beijing",
                        "Country": "China",
                        "Times_Hosted": 2,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -43.173,
                            -22.907
                        ]
                    },
                    "properties": {
                        "Year": "2016 Summer Olympics",
                        "City": "Rio de Janeiro",
                        "Country": "Brazil",
                        "Times_Hosted": 1,
                        "Season": "S"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            2.35611,
                            48.8682
                        ]
                    },
                    "properties": {
                        "Year": "2024 Summer Olympics",
                        "City": "Paris",
                        "Country": "France",
                        "Times_Hosted": 2,
                        "Season": "S",
                        "Details": "The 1896 Summer Olympics, officially known as the Games of the I Olympiad, were held in Athens, Greece from April 6-15, 1896. Here are the key facts about these inaugural modern Olympic Games.",
                        "Image": "./olympics/img/2024-france.png"
                    }
                },
            ]
        };

        const winterVenues = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            116.38,
                            39.917
                        ]
                    },
                    "properties": {
                        "Year": "2022 Winter Olympics",
                        "City": "Beijing",
                        "Country": "China",
                        "Times_Hosted": 2,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            6.87,
                            45.923
                        ]
                    },
                    "properties": {
                        "Year": "1924 Winter Olympics",
                        "City": "Chamonix",
                        "Country": "France",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            9.833,
                            46.5
                        ]
                    },
                    "properties": {
                        "Year": "1928 & 1948 Winter Olympics",
                        "City": "St. Moritz",
                        "Country": "Switzerland",
                        "Times_Hosted": 2,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -73.985,
                            44.286
                        ]
                    },
                    "properties": {
                        "Year": "1932 & 1980 Winter Olympics",
                        "City": "Lake Placid",
                        "Country": "United States",
                        "Times_Hosted": 2,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            11.15,
                            47.5
                        ]
                    },
                    "properties": {
                        "Year": "1936 Winter Olympics",
                        "City": "Garmisch-Partenkirchen",
                        "Country": "Germany",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            10.75,
                            59.95
                        ]
                    },
                    "properties": {
                        "Year": "1952 Winter Olympics",
                        "City": "Oslo",
                        "Country": "Norway",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            12.133,
                            46.533
                        ]
                    },
                    "properties": {
                        "Year": "1956 Winter Olympics",
                        "City": "Cortina",
                        "Country": "Italy",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -120.235,
                            39.196
                        ]
                    },
                    "properties": {
                        "Year": "1960 Winter Olympics",
                        "City": "Squaw Valley",
                        "Country": "United States",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            11.383,
                            47.267
                        ]
                    },
                    "properties": {
                        "Year": "1964 & 1976 Winter Olympics",
                        "City": "Innsbruck",
                        "Country": "Austria",
                        "Times_Hosted": 2,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            5.722,
                            45.2
                        ]
                    },
                    "properties": {
                        "Year": "1968 Winter Olympics",
                        "City": "Grenoble",
                        "Country": "France",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            141.35,
                            43.067
                        ]
                    },
                    "properties": {
                        "Year": "1972 Winter Olympics",
                        "City": "Sapporo",
                        "Country": "Japan",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            18.417,
                            43.867
                        ]
                    },
                    "properties": {
                        "Year": "1984 Winter Olympics",
                        "City": "Sarajevo",
                        "Country": "Yugoslavia",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -114.071,
                            51.049
                        ]
                    },
                    "properties": {
                        "Year": "1988 Winter Olympics",
                        "City": "Calgary",
                        "Country": "Canada",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            6.393,
                            45.678
                        ]
                    },
                    "properties": {
                        "Year": "1992 Winter Olympics",
                        "City": "Albertville",
                        "Country": "France",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            10.433,
                            61.13
                        ]
                    },
                    "properties": {
                        "Year": "1994 Winter Olympics",
                        "City": "Lillehammer",
                        "Country": "Norway",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            138.1,
                            36.25
                        ]
                    },
                    "properties": {
                        "Year": "1998 Winter Olympics",
                        "City": "Nagano",
                        "Country": "Japan",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -111.88,
                            40.75
                        ]
                    },
                    "properties": {
                        "Year": "2002 Winter Olympics",
                        "City": "Salt Lake City",
                        "Country": "United States",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            7.7,
                            45.067
                        ]
                    },
                    "properties": {
                        "Year": "2006 Winter Olympics",
                        "City": "Turin",
                        "Country": "Italy",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -123.121,
                            49.283
                        ]
                    },
                    "properties": {
                        "Year": "2010 Winter Olympics",
                        "City": "Vancouver",
                        "Country": "Canada",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            39.72,
                            43.585
                        ]
                    },
                    "properties": {
                        "Year": "2014 Winter Olympics",
                        "City": "Sochi",
                        "Country": "Russia",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            128.4,
                            37.367
                        ]
                    },
                    "properties": {
                        "Year": "2018 Winter Olympics",
                        "City": "Pyeongchang",
                        "Country": "South Korea",
                        "Times_Hosted": 1,
                        "Season": "W"
                    }
                }]
        };
        /**
         * Assign a unique id to each venue. You'll use this `id`
         * later to associate each point on the map with a listing
         * in the sidebar.
         */
        summerVenues.features.forEach((summerVenue, i) => {
            summerVenue.properties.id = i;
        });
        winterVenues.features.forEach((winterVenue, i) => {
            winterVenue.properties.id = i;
        });

        /**
         * Wait until the map loads to make changes to the map.
         */
        map.on('load', () => {
            // make sidebar listings
            buildLocationList(summerVenues);
            buildLocationList(winterVenues);
            // add source and layer for venues
            map.addSource('summer_venues', {
                type: 'geojson',
                data: summerVenues,
                cluster: true,
                clusterMaxZoom: 14, // Max zoom to cluster points on
                clusterRadius: 50, // Radius of each cluster when clustering points (defaults to 50)
                generateId: true
            });
            map.addSource('winter_venues', {
                type: 'geojson',
                data: winterVenues,
                cluster: true,
                clusterMaxZoom: 14, // Max zoom to cluster points on
                clusterRadius: 50, // Radius of each cluster when clustering points (defaults to 50)
                generateId: true
            });

            // +++++++++++++ SUMMER VENUES +++++++++++++
            // add the layers for the clusters and unclustered points
            map.addLayer({
                id: 'summer_clusters',
                type: 'circle',
                source: 'summer_venues',
                filter: ['all', ['>', 'point_count', 0]],
                paint: {
                    'circle-color': '#FEB710',
                    'circle-radius': [
                        'step',
                        ['get', 'point_count'],
                        8,
                        1,
                        16,
                        3,
                        24
                    ],
                    'circle-stroke-width': 2,
                    'circle-stroke-color': '#000'
                }
            });
            // add the unclustered points layer
            map.addLayer({
                id: 'summer_unclustered_points',
                type: 'symbol',
                source: 'summer_venues',
                // create a filter that will hide the clusters and only show the points
                filter: ['!', ['has', 'point_count']],
                layout: {
                    'icon-image': 'summer_marker',
                    'icon-size': 0.5,
                    'icon-allow-overlap': true
                }
            });
            // add a label layer for the clusters
            map.addLayer({
                id: 'summer_cluster_count',
                type: 'symbol',
                source: 'summer_venues',
                filter: ['has', 'point_count'],
                layout: {
                    'text-field': '{point_count_abbreviated}',
                    'text-font': ['Arial Unicode MS Bold', 'DIN Offc Pro Medium'],
                    'text-size': 12
                }
            });
            // add a listener for the click event on the clusters to expand the cluster and zoom in
            map.on('click', 'summer_clusters', (e) => {
                const features = map.queryRenderedFeatures(e.point, {
                    layers: ['summer_clusters']
                });
                const clusterId = features[0].properties.cluster_id;
                map.getSource('summer_venues').getClusterExpansionZoom(clusterId, (err, zoom) => {
                    if (err) return;
                    map.easeTo({
                        center: features[0].geometry.coordinates,
                        zoom: zoom
                    });
                });
            });

            // +++++++++++++ WINTER VENUES +++++++++++++
            // add the layers for the clusters and unclustered points
            map.addLayer({
                id: 'winter_clusters',
                type: 'circle',
                source: 'winter_venues',
                filter: ['all', ['>', 'point_count', 0]],
                paint: {
                    'circle-color': '#3BC4FF',
                    'circle-radius': [
                        'step',
                        ['get', 'point_count'],
                        8,
                        1,
                        16,
                        3,
                        24
                    ],
                    'circle-stroke-width': 2,
                    'circle-stroke-color': '#000'
                }
            });
            // add the unclustered points layer
            map.addLayer({
                id: 'winter_unclustered_points',
                type: 'symbol',
                source: 'winter_venues',
                // create a filter that will hide the clusters and only show the points
                filter: ['!', ['has', 'point_count']],
                layout: {
                    'icon-image': 'winter_marker',
                    'icon-size': 0.5,
                    'icon-allow-overlap': true
                }
            });
            // add a label layer for the clusters
            map.addLayer({
                id: 'winter_cluster_count',
                type: 'symbol',
                source: 'winter_venues',
                filter: ['has', 'point_count'],
                layout: {
                    'text-field': '{point_count_abbreviated}',
                    'text-font': ['Arial Unicode MS Bold', 'DIN Offc Pro Medium'],
                    'text-size': 12
                }
            });
            // add a listener for the click event on the clusters to expand the cluster and zoom in
            map.on('click', 'winter_clusters', (e) => {
                const features = map.queryRenderedFeatures(e.point, {
                    layers: ['winter_clusters']
                });
                const clusterId = features[0].properties.cluster_id;
                map.getSource('winter_venues').getClusterExpansionZoom(clusterId, (err, zoom) => {
                    if (err) return;
                    map.easeTo({
                        center: features[0].geometry.coordinates,
                        zoom: zoom
                    });
                });
            });

            // add a listener for the click event on the unclustered points to display a popup
            map.on('click', 'summer_unclustered_points', (e) => {
                const coordinates = e.features[0].geometry.coordinates.slice();
                const { Year, City, Country, Times_Hosted, Season } = e.features[0].properties;
                const details = e.features[0].properties.Details;
                const description = `<h3>${City}, ${Country}</h3><h4>${Year}</h4><p>${details}</p>`;
                // add the description to the details container
                // display the details container
                document.querySelector('.detail-bar').style.display = 'block';
                document.querySelector('.detail-bar').innerHTML = description;
            });

        });

        /**
         * Add a listing for each venue to the sidebar.
         **/
        function buildLocationList(season) {
            for (const venue of season.features) {
                /* Add a new listing section to the sidebar. */
                const listings = document.getElementById('listings');
                const listing = listings.appendChild(document.createElement('div'));
                /* Assign a unique `id` to the listing. */
                listing.id = `listing-${venue.properties.id}`;
                /* Assign the `item` class to each listing for styling. */
                listing.className = 'item';

                /* Add the link to the individual listing created above. */
                const link = listing.appendChild(document.createElement('a'));
                link.href = '#';
                link.className = 'title';
                link.id = `link-${venue.properties.id}`;
                link.innerHTML = `${venue.properties.City}` + ' &middot; ' + `${venue.properties.Country}`;

                /* Add details to the individual listing. */
                const details = listing.appendChild(document.createElement('div'));
                // details.innerHTML = `${venue.properties.Times_Hosted}` + ' &middot; ' + `${venue.properties.Season}`;
                if (venue.properties.Year) {
                    details.innerHTML += `${venue.properties.Year}`;
                }

                /**
                 * Listen to the element and when it is clicked, do four things:
                 * 1. Update the `currentFeature` to the venue associated with the clicked link
                 * 2. Fly to the point
                 * 3. Close all other popups and display popup for clicked venue
                 * 4. Highlight listing in sidebar (and remove highlight for all other listings)
                 **/
                link.addEventListener('click', function () {
                    for (const feature of summerVenues.features) {
                        if (this.id === `link-${feature.properties.id}`) {
                            flyToVenue(feature);
                            // createPopUp(feature);
                        }
                    }
                    const activeItem = document.getElementsByClassName('active');
                    if (activeItem[0]) {
                        activeItem[0].classList.remove('active');
                    }
                    this.parentNode.classList.add('active');
                });
            }
        }

        /**
         * Use Mapbox GL JS's `flyTo` to move the camera smoothly
         * a given center point.
         **/
        function flyToVenue(currentFeature) {
            console.log(currentFeature);
            map.flyTo({
                center: currentFeature.geometry.coordinates,
                zoom: 12
            });
        }


        // search
        const searchElement = document.getElementById('search');
        const clearButton = document.getElementById('clear-search');

        clearButton.addEventListener('click', function () {
            // Clear the search input
            searchElement.value = '';
            // Clear the listings
            const listings = document.getElementById('listings');

            // display all listings again
            summerVenues.features.forEach((venue, i) => {
                document.getElementById(`listing-${venue.properties.id}`).style.display = 'block';
            });
        });

        searchElement.addEventListener('input', function (e) {
            const value = e.target.value;

            venues.features.forEach((venue, i) => {
                if (venue.properties.City.toLowerCase().includes(value.toLowerCase())) {
                    // make the corresponding listing visible and active
                    document.getElementById(`listing-${venue.properties.id}`).style.display = 'block';
                } else {
                    // hide the listing
                    document.getElementById(`listing-${venue.properties.id}`).style.display = 'none';
                }
            });
        });
    </script>
</body>

</html>